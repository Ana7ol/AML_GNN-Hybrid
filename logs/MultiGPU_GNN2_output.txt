Mon Jun  9 00:00:23 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.86.10              Driver Version: 570.86.10      CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:06:00.0 Off |                    0 |
| N/A   41C    P0             25W /  250W |       4MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  Tesla V100-PCIE-32GB           On  |   00000000:2F:00.0 Off |                    0 |
| N/A   41C    P0             25W /  250W |       4MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  Tesla V100-PCIE-32GB           On  |   00000000:86:00.0 Off |                    0 |
| N/A   40C    P0             24W /  250W |       4MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  Tesla V100-PCIE-32GB           On  |   00000000:D8:00.0 Off |                    0 |
| N/A   40C    P0             25W /  250W |       4MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Preprocessing data and converting to NumPy arrays (for PyG)...
Found 4 GPUs. Spawning DDP processes.
Running DDP on rank 0 / GPU 0.
Using loss function: FocalLoss
FocalLoss using alpha=0.25, gamma=2
Running DDP on rank 1 / GPU 1.
Using loss function: FocalLoss
Running DDP on rank 3 / GPU 3.
Using loss function: FocalLoss
Running DDP on rank 2 / GPU 2.
Using loss function: FocalLoss
--- Epoch 1/5 Summary (Rank 0) ---
  Avg Train Loss: 0.7661, Duration: 863.29s
  Global Eval ==> AUROC: 0.9374, AUPRC: 0.0096
    F1 Score (at threshold 0.9): 0.0159
    Classification Report:
              precision    recall  f1-score   support

   Licit (0)       1.00      0.95      0.98   1383855
 Illicit (1)       0.01      0.55      0.02       925

    accuracy                           0.95   1384780
   macro avg       0.50      0.75      0.50   1384780
weighted avg       1.00      0.95      0.98   1384780

    Confusion matrix:
[[1321151   62704]
 [    414     511]]

--- Optimizing Threshold for Best TP/TN Balance (ROC Curve) ---
  Optimal threshold for TP/TN balance: 0.7028
    Recall (TP Rate) at this threshold: 0.9286
    Specificity (TN Rate) at this threshold: 0.8296

    --- Classification Report (at Best ROC Threshold) ---
              precision    recall  f1-score   support

   Licit (0)       1.00      0.83      0.91   1383855
 Illicit (1)       0.00      0.93      0.01       925

    accuracy                           0.83   1384780
   macro avg       0.50      0.88      0.46   1384780
weighted avg       1.00      0.83      0.91   1384780

    --- Confusion Matrix (at Best ROC Threshold) ---
[[1148034  235821]
 [     66     859]]
--- Epoch 2/5 Summary (Rank 0) ---
  Avg Train Loss: 0.4870, Duration: 861.89s
  Global Eval ==> AUROC: 0.9138, AUPRC: 0.0312
    F1 Score (at threshold 0.9): 0.0391
    Classification Report:
              precision    recall  f1-score   support

   Licit (0)       1.00      0.99      1.00   1383855
 Illicit (1)       0.02      0.19      0.04       925

    accuracy                           0.99   1384780
   macro avg       0.51      0.59      0.52   1384780
weighted avg       1.00      0.99      1.00   1384780

    Confusion matrix:
[[1375745    8110]
 [    745     180]]

--- Optimizing Threshold for Best TP/TN Balance (ROC Curve) ---
  Optimal threshold for TP/TN balance: 0.1922
    Recall (TP Rate) at this threshold: 0.9276
    Specificity (TN Rate) at this threshold: 0.8101

    --- Classification Report (at Best ROC Threshold) ---
              precision    recall  f1-score   support

   Licit (0)       1.00      0.81      0.90   1383855
 Illicit (1)       0.00      0.93      0.01       925

    accuracy                           0.81   1384780
   macro avg       0.50      0.87      0.45   1384780
weighted avg       1.00      0.81      0.89   1384780

    --- Confusion Matrix (at Best ROC Threshold) ---
[[1121105  262750]
 [     67     858]]
--- Epoch 3/5 Summary (Rank 0) ---
  Avg Train Loss: 0.2900, Duration: 858.97s
  Global Eval ==> AUROC: 0.8824, AUPRC: 0.0283
    F1 Score (at threshold 0.9): 0.0285
    Classification Report:
              precision    recall  f1-score   support

   Licit (0)       1.00      0.99      1.00   1383855
 Illicit (1)       0.02      0.18      0.03       925

    accuracy                           0.99   1384780
   macro avg       0.51      0.58      0.51   1384780
weighted avg       1.00      0.99      1.00   1384780

    Confusion matrix:
[[1373588   10267]
 [    763     162]]

--- Optimizing Threshold for Best TP/TN Balance (ROC Curve) ---
  Optimal threshold for TP/TN balance: 0.0208
    Recall (TP Rate) at this threshold: 0.9243
    Specificity (TN Rate) at this threshold: 0.7931

    --- Classification Report (at Best ROC Threshold) ---
              precision    recall  f1-score   support

   Licit (0)       1.00      0.79      0.88   1383855
 Illicit (1)       0.00      0.92      0.01       925

    accuracy                           0.79   1384780
   macro avg       0.50      0.86      0.45   1384780
weighted avg       1.00      0.79      0.88   1384780

    --- Confusion Matrix (at Best ROC Threshold) ---
[[1097536  286319]
 [     70     855]]
Mon Jun  9 01:06:00 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.86.10              Driver Version: 570.86.10      CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Tesla V100-PCIE-32GB           On  |   00000000:06:00.0 Off |                    0 |
| N/A   32C    P0             23W /  250W |       4MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   1  Tesla V100-PCIE-32GB           On  |   00000000:2F:00.0 Off |                    0 |
| N/A   32C    P0             23W /  250W |       4MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   2  Tesla V100-PCIE-32GB           On  |   00000000:86:00.0 Off |                    0 |
| N/A   32C    P0             23W /  250W |       4MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
|   3  Tesla V100-PCIE-32GB           On  |   00000000:D8:00.0 Off |                    0 |
| N/A   33C    P0             23W /  250W |       4MiB /  32768MiB |      0%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Preprocessing data and converting to NumPy arrays (for PyG)...
Found 4 GPUs. Spawning DDP processes.
Running DDP on rank 0 / GPU 0.
Using loss function: FocalLoss
FocalLoss using alpha=0.25, gamma=2
Running DDP on rank 2 / GPU 2.
Using loss function: FocalLoss
Running DDP on rank 3 / GPU 3.
Using loss function: FocalLoss
Running DDP on rank 1 / GPU 1.
Using loss function: FocalLoss
--- Epoch 1/5 Summary (Rank 0) ---
  Avg Train Loss: 0.8398, Duration: 873.70s
  Global Eval ==> AUROC: 0.9355, AUPRC: 0.0081
    F1 Score (at threshold 0.9): 0.0148
    Classification Report:
              precision    recall  f1-score   support

   Licit (0)       1.00      0.94      0.97   1383855
 Illicit (1)       0.01      0.64      0.01       925

    accuracy                           0.94   1384780
   macro avg       0.50      0.79      0.49   1384780
weighted avg       1.00      0.94      0.97   1384780

    Confusion matrix:
[[1305853   78002]
 [    337     588]]

--- Optimizing Threshold for Best TP/TN Balance (ROC Curve) ---
  Optimal threshold for TP/TN balance: 0.7634
    Recall (TP Rate) at this threshold: 0.9200
    Specificity (TN Rate) at this threshold: 0.8315

    --- Classification Report (at Best ROC Threshold) ---
              precision    recall  f1-score   support

   Licit (0)       1.00      0.83      0.91   1383855
 Illicit (1)       0.00      0.92      0.01       925

    accuracy                           0.83   1384780
   macro avg       0.50      0.88      0.46   1384780
weighted avg       1.00      0.83      0.91   1384780

    --- Confusion Matrix (at Best ROC Threshold) ---
[[1150705  233150]
 [     74     851]]
--- Epoch 2/5 Summary (Rank 0) ---
  Avg Train Loss: 0.5913, Duration: 864.75s
  Global Eval ==> AUROC: 0.9409, AUPRC: 0.0168
    F1 Score (at threshold 0.9): 0.0158
    Classification Report:
              precision    recall  f1-score   support

   Licit (0)       1.00      0.95      0.97   1383855
 Illicit (1)       0.01      0.61      0.02       925

    accuracy                           0.95   1384780
   macro avg       0.50      0.78      0.49   1384780
weighted avg       1.00      0.95      0.97   1384780

    Confusion matrix:
[[1313507   70348]
 [    357     568]]

--- Optimizing Threshold for Best TP/TN Balance (ROC Curve) ---
  Optimal threshold for TP/TN balance: 0.7314
    Recall (TP Rate) at this threshold: 0.9189
    Specificity (TN Rate) at this threshold: 0.8362

    --- Classification Report (at Best ROC Threshold) ---
              precision    recall  f1-score   support

   Licit (0)       1.00      0.84      0.91   1383855
 Illicit (1)       0.00      0.92      0.01       925

    accuracy                           0.84   1384780
   macro avg       0.50      0.88      0.46   1384780
weighted avg       1.00      0.84      0.91   1384780

    --- Confusion Matrix (at Best ROC Threshold) ---
[[1157134  226721]
 [     75     850]]
--- Epoch 3/5 Summary (Rank 0) ---
  Avg Train Loss: 0.5067, Duration: 867.21s
  Global Eval ==> AUROC: 0.9376, AUPRC: 0.0236
    F1 Score (at threshold 0.9): 0.0180
    Classification Report:
              precision    recall  f1-score   support

   Licit (0)       1.00      0.97      0.98   1383855
 Illicit (1)       0.01      0.41      0.02       925

    accuracy                           0.97   1384780
   macro avg       0.50      0.69      0.50   1384780
weighted avg       1.00      0.97      0.98   1384780

    Confusion matrix:
[[1342717   41138]
 [    542     383]]

--- Optimizing Threshold for Best TP/TN Balance (ROC Curve) ---
  Optimal threshold for TP/TN balance: 0.5810
    Recall (TP Rate) at this threshold: 0.9395
    Specificity (TN Rate) at this threshold: 0.8249

    --- Classification Report (at Best ROC Threshold) ---
              precision    recall  f1-score   support

   Licit (0)       1.00      0.82      0.90   1383855
 Illicit (1)       0.00      0.94      0.01       925

    accuracy                           0.82   1384780
   macro avg       0.50      0.88      0.46   1384780
weighted avg       1.00      0.82      0.90   1384780

    --- Confusion Matrix (at Best ROC Threshold) ---
[[1141489  242366]
 [     56     869]]
Mon Jun  9 09:58:30 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.86.10              Driver Version: 570.86.10      CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA H100 80GB HBM3          Off |   00000000:4E:00.0 Off |                    0 |
| N/A   35C    P0             73W /  700W |       5MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA H100 80GB HBM3          Off |   00000000:5F:00.0 Off |                    0 |
| N/A   34C    P0             72W /  700W |      77MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA H100 80GB HBM3          Off |   00000000:CB:00.0 Off |                    0 |
| N/A   33C    P0             72W /  700W |       5MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA H100 80GB HBM3          Off |   00000000:DB:00.0 Off |                    0 |
| N/A   34C    P0             69W /  700W |       5MiB /  81559MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
Preprocessing data and converting to NumPy arrays (for PyG)...
Found 4 GPUs. Spawning DDP processes.
Running DDP on rank 2 / GPU 2.
Using loss function: FocalLoss
Running DDP on rank 0 / GPU 0.
Using loss function: FocalLoss
Running DDP on rank 1 / GPU 1.
Using loss function: FocalLoss
Running DDP on rank 3 / GPU 3.
Using loss function: FocalLoss
FocalLoss using alpha=0.25, gamma=2
--- Epoch 1/5 Summary (Rank 0) ---
  Avg Train Loss: 0.8503, Duration: 120.52s
  Global Eval ==> AUROC: 0.9347, AUPRC: 0.0080
    F1 Score (at threshold 0.98): 0.0000
    Classification Report:
              precision    recall  f1-score   support

   Licit (0)       1.00      1.00      1.00   1383855
 Illicit (1)       0.00      0.00      0.00       925

    accuracy                           1.00   1384780
   macro avg       0.50      0.50      0.50   1384780
weighted avg       1.00      1.00      1.00   1384780

    Confusion matrix:
[[1383855       0]
 [    925       0]]

--- Optimizing Threshold for Best TP/TN Balance (ROC Curve) ---
  Optimal threshold for TP/TN balance: 0.7776
    Recall (TP Rate) at this threshold: 0.9114
    Specificity (TN Rate) at this threshold: 0.8353

    --- Classification Report (at Best ROC Threshold) ---
              precision    recall  f1-score   support

   Licit (0)       1.00      0.84      0.91   1383855
 Illicit (1)       0.00      0.91      0.01       925

    accuracy                           0.84   1384780
   macro avg       0.50      0.87      0.46   1384780
weighted avg       1.00      0.84      0.91   1384780

    --- Confusion Matrix (at Best ROC Threshold) ---
[[1155884  227971]
 [     82     843]]
